## æ€§èƒ½ä¼˜åŒ–
### serviceWorker
#### ç®€ä»‹
web worker:
ä¸ºäº†è§£å†³jså•çº¿ç¨‹å¼Šç«¯ï¼Œweb workerè¢«åˆ›é€ ï¼Œå®ƒæ˜¯è„±ç¦»åœ¨ä¸»çº¿ç¨‹å¤–çš„ï¼Œå¯ä»¥å§ä¸€äº›å¤æ‚è´¹æ—¶çš„æ“ä½œäº¤ç»™ä»–ã€‚swåœ¨web workeråŸºç¡€ä¸Šå¢åŠ ç¦»çº¿ç¼“å­˜èƒ½åŠ›ã€‚
swåŸºäºWEB Workerè€Œæ¥çš„,æ˜¯ä»‹äºæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨ï¼Œä¸»è¦ä½œç”¨æ˜¯ç¦»çº¿èµ„æºç¼“å­˜ï¼Œå¯ä»¥ç¼“å­˜apiè¯·æ±‚ä¸é™æ€èµ„æºã€‚ä¹Ÿå¯ä»¥æ‹¦æˆªç½‘ç»œè¯·æ±‚ï¼Œæ”¯æŒæ¨é€ï¼Œå¹¶ä¸”å¯ä»¥è®©å¼€å‘è€…è‡ªå·±æ§åˆ¶ç®¡ç†ç¼“å­˜çš„å†…å®¹ä»¥åŠç‰ˆæœ¬ã€‚
æ¢å¥è¯è¯´ä»–å¯ä»¥æŠŠä½ åº”ç”¨é‡Œçš„æ‰€æœ‰é™æ€åŠ¨æ€èµ„æºæ ¹æ®ä¸åŒç­–ç•¥ç¼“å­˜èµ·æ¥ï¼Œåœ¨ä½ ä¸‹æ¬¡æ‰“å¼€æ—¶ä¸å†éœ€è¦å»æœåŠ¡å™¨è¯·æ±‚ï¼Œè¿™æ ·ä¸€æ¥å°±å‡å°‘äº†ç½‘ç»œè€—æ—¶ï¼Œä½¿å¾—webåº”ç”¨å¯ä»¥ç§’å¼€ï¼Œå¹¶ä¸”åœ¨ç¦»çº¿ç¯å¢ƒä¸‹ä¹Ÿå˜å¾—å¯ç”¨ã€‚

#### ç‰¹ç‚¹
1.swå·¥ä½œåœ¨worker contextä¸­ï¼Œæ— æƒè®¿é—®æ“ä½œdomã€‚
2.å¯ä»¥é€šè¿‡postMessageç»™å…¶ä»–jsä¼ æ•°æ®ã€‚
3.ä¸ä¸»çº¿ç¨‹ç‹¬ç«‹ä¸ä¼šè¢«é˜»å¡ã€‚
4.swæ˜¯æµè§ˆå™¨çš„è¿›ç¨‹ï¼Œè€Œä¸æ˜¯æµè§ˆå™¨å†…æ ¸ä¸‹çš„ä¸€ä¸ªçº¿ç¨‹ã€‚å®‰è£…åï¼Œå¯ä»¥åœ¨å¤šä¸ªé¡µé¢ä½¿ç”¨ã€‚å…³é—­é¡µé¢swä¸ä¼šæ¶ˆå¤±ã€‚

#### workbox
1.é¦–å…ˆæ³¨å†Œswæ–‡ä»¶
```html
<script>
// Check that service workers are supported
if ('serviceWorker' in navigator) {
  // Use the window load event to keep the page load performant
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/service-worker.js');
  });
}
</script>
```
2.å¯¼å…¥workboxæ–‡ä»¶
```js
importScripts('https://storage.googleapis.com/workbox-cdn/releases/4.3.1/workbox-sw.js');

if (workbox) {
  console.log(`Yay! Workbox is loaded ğŸ‰`);
} else {
  console.log(`Boo! Workbox didn't load ğŸ˜¬`);
}
```
3.ä½¿ç”¨
```js
workbox.routing.registerRoute(
  new RegExp('.*\.js'),
  workbox.strategies.networkFirst()
);
```
registerRouteç¬¬ä¸€ä¸ªå‚æ•°åŒ¹é…ç¼“å­˜urlï¼Œç¬¬äºŒä¸ªå‚æ•°å®šä¹‰ç¼“å­˜ç­–ç•¥ã€‚

* networkFirst:æœ‰ç½‘ä»¥ç½‘ç»œè¯·æ±‚ä¼˜å…ˆï¼Œæ²¡ç½‘å°±è¯·æ±‚ç¼“å­˜ã€‚
* staleWhileRevalidateï¼šä»ç¼“å­˜æä¾›ï¼Œåœ¨åå°æ›´æ–°ç¼“å­˜å†…å®¹ã€‚
* cacheFirstï¼šç¼“å­˜ä¼˜å…ˆï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´

```js
workbox.routing.registerRoute(
  // Cache CSS files
  /.*\.css/,
  // Use cache but update in the background ASAP
  workbox.strategies.staleWhileRevalidate({
    // Use a custom cache name
    cacheName: 'css-cache',
  })
);

workbox.routing.registerRoute(
  // Cache image files
  /.*\.(?:png|jpg|jpeg|svg|gif)/,
  // Use the cache if it's available
  workbox.strategies.cacheFirst({
    // Use a custom cache name
    cacheName: 'image-cache',
    plugins: [
      new workbox.expiration.Plugin({
        // Cache only 20 images
        maxEntries: 20,
        // Cache for a maximum of a week
        maxAgeSeconds: 7 * 24 * 60 * 60,
      })
    ],
  })
);
```

### èµ„æºä¼˜åŒ–
webpack:
å‹ç¼©css,jsï¼Œä½¿ç”¨code splitingä½¿æ‰“åŒ…èµ„æºæ›´åˆç†ã€‚
css sprite:
ä½¿ç”¨é›ªç¢§å›¾ï¼Œå¤šå¼ å›¾åˆå¹¶åœ¨ä¸€èµ·ï¼Œå‡å°‘è¯·æ±‚æ•°ã€‚
å›¾æ ‡ï¼š
é€‰æ‹©å­—ä½“å›¾æ ‡ï¼Œæ¯”å¦‚é˜¿é‡ŒçŸ¢é‡å›¾æ ‡åº“
cdn:
åˆç†ä½¿ç”¨cdnå­˜å‚¨é™æ€èµ„æºã€‚
gzip:å¯ç”¨gzipï¼Œéœ€è¦åœ¨æœåŠ¡ç«¯è®¾ç½®ã€‚


### åŠ è½½ä¼˜åŒ–
* å‡å°‘httpè¯·æ±‚ï¼Œé¦–é¡µå°½é‡ä¸è¶…è¿‡4ä¸ªã€‚
* åˆç†åˆ©ç”¨ç¼“å­˜ã€‚ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ï¼Œservice workerï¼Œcdnç­‰ã€‚
* æŒ‰éœ€åŠ è½½ï¼šæ‡’åŠ è½½ï¼ˆç»„ä»¶æ‡’åŠ è½½ï¼Œè·¯ç”±æ‡’åŠ è½½ï¼‰ï¼Œæ»šå±åŠ è½½ï¼Œmedia queryåŠ è½½

### ä»£ç å±‚é¢
1.å‡å°‘é‡ç»˜å›æµï¼Œæé«˜é¡µé¢æ€§èƒ½ï¼Œè¯¦è§æµè§ˆå™¨é‡ç»˜å›æµã€‚
2.ä½¿ç”¨hocï¼Œrender props,è£…é¥°å™¨ç­‰æå–å…¬ç”¨é€»è¾‘ï¼Œç¼©å‡ä»£ç ä½“ç§¯ã€‚
3.åŸºæœ¬ä»£ç ä¹¦å†™è§„èŒƒï¼š

01.æ‰§è¡Œä¼˜åŒ–
* csså†™åœ¨å¤´ï¼Œjså†™åœ¨å°¾ã€‚
* å°½é‡é¿å…img,iframe srcç­‰äºnull
* å°½é‡é¿å…é‡åˆ¶å›¾åƒå¤§å°

02.cssä¼˜åŒ–
* é¿å…htmlé‡Œå†™style
* é¿å…cssè¡¨è¾¾å¼ï¼šCSSè¡¨è¾¾å¼çš„æ‰§è¡Œéœ€è·³å‡ºCSSæ ‘çš„æ¸²æŸ“
* ç§»é™¤ç©ºçš„è§„åˆ™
* ä¸å£°æ˜è¿‡å¤šfont-size

[é›…è™å‰ç«¯ä¼˜åŒ–35æ¡è§„åˆ™](https://github.com/creeperyang/blog/issues/1)

### é¢„æ¸²æŸ“
é¢„æ¸²æŸ“åŸºæœ¬ä¸Šæ˜¯æ‰“å¼€ä¸€ä¸ªæ— ç•Œé¢çš„æµè§ˆå™¨ï¼Œæ ¹æ®routeæ¸²æŸ“å‡ºhtmlï¼Œå®¢æˆ·ç«¯æ‹¿åˆ°ä»–ç›´æ¥æ¸²æŸ“å‡ºé¡µé¢ï¼Œä¸ç”¨ç­‰jsæ¸²æŸ“ã€‚
ä½¿ç”¨PrerenderSPAPlugin
```javascript
const path = require('path')
const PrerenderSPAPlugin = require('prerender-spa-plugin')

module.exports = {
  plugins: [
    ...
    new PrerenderSPAPlugin({
      // Required - The path to the webpack-outputted app to prerender.
      staticDir: path.join(__dirname, 'dist'),
      // Required - Routes to render.
      routes: [ '/', '/about', '/some/deep/nested/route' ],
    })
  ]
}
```
å®šä¹‰éœ€è¦é¢„æ¸²æŸ“æ–‡ä»¶è·¯å¾„å’Œroutes.
å‚è€ƒï¼š
[é¦–é¡µç™½å±ä¼˜åŒ–å®è·µ](https://segmentfault.com/a/1190000020383064?name=%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96&description=&isPrivate=1)
[prerender-spa-plugin](https://github.com/chrisvfritz/prerender-spa-plugin#prerendererrenderer-puppeteer-options)

